using Moq;
using System;
using System.Collections.Generic;
using System.Text;
using WeHackSecrets.Services.Actions;

namespace WeHackSecrets.Tests.Unit.Services.Exploits.BrokenAccessControl
{
    public class SecretsListBuilder
    {
        private readonly List<Mock<ISecretsList>> _list = new List<Mock<ISecretsList>>();

        public SecretsListBuilder AddValid()
        {
            var secretsList = new Mock<ISecretsList>();
            secretsList.Setup(x => x.GetTargetSecret("TargetKey")).Returns("Secret1234");

            _list.Add(secretsList);
            return this;
        }

        public SecretsListBuilder AddInvalid()
        {
            var secretsList = new Mock<ISecretsList>();
            secretsList.Setup(x => x.GetTargetSecret("TargetKey")).Returns("");

            _list.Add(secretsList);
            return this;
        }

        public SecretsListBuilder AddException()
        {
            var secretsList = new Mock<ISecretsList>();
            secretsList.Setup(x => x.GetTargetSecret("TargetKey")).Returns(() => throw new Exception("End of the world"));

            _list.Add(secretsList);
            return this;
        }

        public List<Mock<ISecretsList>> Build()
        {
            return _list;
        }
    }
}
